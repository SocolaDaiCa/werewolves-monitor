# ğŸŒ™ HÆ°á»›ng Dáº«n PhÃ¡t Triá»ƒn Ban ÄÃªm - Tiáº¿ng Viá»‡t

## ğŸ“‹ TÃ³m Táº¯t Dá»± Ãn

Báº¡n Ä‘ang phÃ¡t triá»ƒn má»™t á»©ng dá»¥ng **Game Master** cho trÃ² chÆ¡i **Werewolves (SÃ³i NgÆ°á»i)**. á»¨ng dá»¥ng nÃ y giÃºp quáº£n trÃ² theo dÃµi cÃ¡c hÃ nh Ä‘á»™ng cá»§a nhÃ¢n váº­t trong trÃ² chÆ¡i.

### Hiá»‡n Táº¡i âœ…
- Werewolf cÆ¡ báº£n (sÃ³i giáº¿t ngÆ°á»i Ä‘Ãªm)

### Cáº§n ThÃªm
- 30+ nhÃ¢n váº­t khÃ¡c vá»›i tÃ­nh nÄƒng ban Ä‘Ãªm

---

## ğŸ¯ CÃ¡c Giai Äoáº¡n PhÃ¡t Triá»ƒn

### Giai Äoáº¡n 1: Cáº¶P (Ráº¥t Quan Trá»ng) âš¡âš¡âš¡
**Thá»i gian: 40-60 giá»**

CÃ¡c nhÃ¢n váº­t quan trá»ng nháº¥t:

1. **TiÃªn Tri** (Seer) - Äiá»u tra: má»¥c tiÃªu lÃ  sÃ³i hay khÃ´ng?
2. **PhÃ¹ Thá»§y** (Witch) - Chá»¯a bá»‡nh/DÃ¹ng Ä‘á»™c (má»—i cÃ¡i 1 láº§n)
3. **Báº£o Vá»‡** (Body Guard) - Báº£o vá»‡ ngÆ°á»i chÆ¡i khá»i cÃ¡i cháº¿t
4. **SÃ³i Con** (Wolf Cub) - SÃ³i Ä‘áº·c biá»‡t
5. **SÃ³i Tuyáº¿t** (Dire Wolf) - SÃ³i Ä‘áº·c biá»‡t khÃ¡c

**Táº¡i sao quan trá»ng?** Cáº§n cÃ³ investigation & protection Ä‘á»ƒ game cÃ¢n báº±ng

---

### Giai Äoáº¡n 2: QUAN TRá»ŒNG âš¡âš¡
**Thá»i gian: 50-80 giá»**

CÃ¡c nhÃ¢n váº­t Ä‘Ãªm Ä‘áº§u & liÃªn há»‡:

1. **Tháº§n TÃ¬nh YÃªu** (Cupid) - Táº¡o cáº·p tÃ¬nh yÃªu (cháº¿t theo nhau)
2. **Káº» Pháº£n Bá»™i** (Minion) - Há»c biáº¿t danh tÃ­nh sÃ³i
3. **Sinh ÄÃ´i** (Mason) - TÃ¬m Sinh ÄÃ´i khÃ¡c
4. **Káº» Say RÆ°á»£u** (Drunk) - Trao Ä‘á»•i vai trÃ² vá»›i ai
5. **Má»¥ GiÃ ** (Old Hag) - Nguyá»n rá»§a ngÆ°á»i chÆ¡i
6. **NgÆ°á»i NhÃ¢n Báº£n** (Doppelganger) - Sao chÃ©p vai trÃ²
7. **NhÃ  TiÃªn Tri** (Nostradamis) - Dá»± Ä‘oÃ¡n ai cháº¿t

**Táº¡i sao quan trá»ng?** Táº¡o ra cÃ¡c liÃªn há»‡ phá»©c táº¡p trong trÃ²

---

### Giai Äoáº¡n 3: TRUNG BÃŒNH âš¡
**Thá»i gian: 60-100 giá»**

CÃ¡c vai trÃ² Ä‘áº·c biá»‡t:

1. **Ma CÃ  Rá»“ng** (Vampire) - Giáº¿t vÃ o buá»•i chiá»u
2. **Káº» SÃ¹ng Äáº¡o** (Cult Leader) - Tuyá»ƒn dá»¥ng ngÆ°á»i chÆ¡i
3. **Thá»£ SÄƒn** (Hunter) - Báº¯n khi bá»‹ loáº¡i
4. **TiÃªn Tri VÅ© Trá»¥** (Aura Seer) - PhÃ¡t hiá»‡n vai trÃ² Ä‘áº·c biá»‡t
5. **ThÃ¡m Tá»­** (P.I) - Äiá»u tra má»‘i liÃªn há»‡
6. **PhÃ¡p SÆ° CÃ¢m** (Spellcaster) - LÃ m im láº·ng
7. **Káº» PhÃ¡ Rá»‘i** (Troublemaker) - HoÃ¡n Ä‘á»•i 2 ngÆ°á»i
8. **Má»¥c SÆ°** (Priest) - Báº£o vá»‡ (1 láº§n)

---

### Giai Äoáº¡n 4: ÃT DÃ™NG ğŸ”¸
**Thá»i gian: 40-60 giá»**

CÃ¡c vai trÃ² hiáº¿m & niche:

- **Há»“n Ma** (Ghost) - Gá»­i tin nháº¯n
- **Ã”ng Káº¹, YÃªu Tinh, XÃ¡c Sá»‘ng, BÃ¡ TÆ°á»›c** - Hiá»‡u á»©ng Ä‘áº·c biá»‡t
- **CÃ¡c vai trÃ² khÃ¡c** - Martyr, Lycan, Time Bandit, v.v.

---

## ğŸ—ï¸ Thay Äá»•i MÃ£ Nguá»“n Cáº§n LÃ m

### 1. Cáº­p Nháº­t Cáº¥u TrÃºc Dá»¯ Liá»‡u

**Tá»‡p: `app/stores/roles.ts`**

ThÃªm 5 trÆ°á»ng vÃ o `Role` interface:

```typescript
interface Role {
  // ... trÆ°á»ng hiá»‡n táº¡i ...
  
  nightOrder: number           // Thá»© tá»± gá»i (1-42)
  actionType: RoleActionType   // Loáº¡i hÃ nh Ä‘á»™ng
  maxUsesPerGame?: number      // Sá»­ dá»¥ng tá»‘i Ä‘a (null = vÃ´ háº¡n)
  displayOrder?: number        // Æ¯u tiÃªn hiá»ƒn thá»‹
  defaultOrderPosition?: number // Vá»‹ trÃ­ máº·c Ä‘á»‹nh
}

// Loáº¡i hÃ nh Ä‘á»™ng
type RoleActionType = 
  'SELECT_PLAYER'   // Chá»n 1 ngÆ°á»i
  | 'DUAL_SELECT'   // Chá»n 2 ngÆ°á»i
  | 'TEXT_INPUT'    // Nháº­p vÄƒn báº£n
  | 'DUAL_OPTION'   // Chá»n giá»¯a 2 tuá»³ chá»n
  | 'ACKNOWLEDGE'   // Chá»‰ xÃ¡c nháº­n
  | 'NONE'          // KhÃ´ng cÃ³ hÃ nh Ä‘á»™ng
```

### 2. Cáº­p Nháº­t Game State

**Tá»‡p: `app/stores/game.ts`**

ThÃªm tráº¡ng thÃ¡i má»›i:

```typescript
// LiÃªn há»‡ giá»¯a ngÆ°á»i chÆ¡i
const lovers = ref<[string, string][]>([])        // Cáº·p tÃ¬nh yÃªu
const possessed = ref<Map<string, string>>()      // NgÆ°á»i nhÃ¢n báº£n sao chÃ©p
const cursed = ref<string[]>([])                  // NgÆ°á»i bá»‹ nguyá»n
const silenced = ref<string[]>([])                // NgÆ°á»i bá»‹ im láº·ng

// Theo dÃµi sá»­ dá»¥ng kháº£ nÄƒng
const witchHealUsed = ref(false)
const witchPoisonUsed = ref(false)
const drunkRealRole = ref({})
```

### 3. ThÃªm NhÃ¢n Váº­t VÃ o Roles

**Tá»‡p: `app/stores/roles.ts`**

Uncomment & cáº­p nháº­t cÃ¡c nhÃ¢n váº­t tá»« dÃ²ng 30+:

```typescript
{
  id: 'seer',
  name: 'Seer',
  nameVi: 'TiÃªn Tri',
  description: 'Each night, choose a player to learn if they are a werewolf or not.',
  descriptionVi: 'Má»—i Ä‘Ãªm, chá»n má»™t ngÆ°á»i chÆ¡i Ä‘á»ƒ biáº¿t há» cÃ³ pháº£i sÃ³i hay khÃ´ng.',
  faction: 'VILLAGER',
  balancePoints: 7,
  nightly: 'ALWAYS',
  nightOrder: 14,           // â† THÃŠM
  actionType: 'SELECT_PLAYER', // â† THÃŠM
  maxUsesPerGame: undefined // â† THÃŠM
}
```

### 4. Cáº­p Nháº­t Components

**Tá»‡p: `app/components/RoleAction.vue`**

Há»— trá»£ táº¥t cáº£ loáº¡i hÃ nh Ä‘á»™ng:
- SELECT_PLAYER: Dropdown chá»n 1 ngÆ°á»i
- DUAL_SELECT: Chá»n 2 ngÆ°á»i khÃ¡c nhau
- TEXT_INPUT: Ã” nháº­p vÄƒn báº£n
- DUAL_OPTION: 2 nÃºt báº¥m
- ACKNOWLEDGE: NÃºt xÃ¡c nháº­n
- NONE: Chá»‰ hiá»ƒn thá»‹

### 5. Cáº­p Nháº­t Xá»­ LÃ½ HÃ nh Äá»™ng

**Tá»‡p: `app/composables/useNightPhaseActions.ts`**

ThÃªm handler cho má»—i nhÃ¢n váº­t:

```typescript
case 'seer':
  handleSeerInvestigation(action)
  break
case 'witch':
  handleWitchAction(action)
  break
case 'bodyguard':
  handleProtection(action)
  break
// ... thÃªm cÃ¡c role khÃ¡c
```

### 6. ThÃªm Báº£n Dá»‹ch

**Tá»‡p: `i18n/locales/en.json` & `vi.json`**

ThÃªm tÃªn & mÃ´ táº£ cho táº¥t cáº£ nhÃ¢n váº­t

---

## ğŸ“Š Thá»© Tá»± Gá»i Ban ÄÃªm (ÄÆ¡n Giáº£n)

```
ÄÃŠM Äáº¦U TIÃŠN:
1. Ghost (Há»“n ma)
2. Cupid (Tháº§n tÃ¬nh yÃªu) 
3. Doppelganger (NgÆ°á»i nhÃ¢n báº£n)
...

Má»–I ÄÃŠM:
5. Werewolf (SÃ³i)
6. Minion (Káº» pháº£n bá»™i) - chá»‰ Ä‘Ãªm Ä‘áº§u
7. Vampire (Ma cÃ  rá»“ng)
...
12. Body Guard (Báº£o vá»‡)
13. Witch (PhÃ¹ thá»§y)
14. Seer (TiÃªn tri)
...

GM Tá»° CHá»ŒN THá»¨ Tá»°:
23. Priest (Má»¥c sÆ°)
24. Martyr (Káº» tá»­ Ä‘áº¡o)
... vÃ  cÃ¡c vai trÃ² khÃ¡c
```

---

## ğŸ§ª VÃ­ Dá»¥: Triá»ƒn Khai TiÃªn Tri

### BÆ°á»›c 1: ThÃªm vÃ o roles.ts

```typescript
{
  id: 'seer',
  name: 'Seer',
  nameVi: 'TiÃªn Tri',
  description: 'Each night, choose a player to learn if they are a werewolf or not.',
  descriptionVi: 'Má»—i Ä‘Ãªm, chá»n má»™t ngÆ°á»i chÆ¡i Ä‘á»ƒ biáº¿t há» cÃ³ pháº£i sÃ³i hay khÃ´ng.',
  faction: 'VILLAGER',
  balancePoints: 7,
  nightly: 'ALWAYS',
  nightOrder: 14,
  actionType: 'SELECT_PLAYER',
  maxUsesPerGame: undefined
}
```

### BÆ°á»›c 2: ThÃªm handler vÃ o useNightPhaseActions.ts

```typescript
case 'seer':
  handleSeerInvestigation(action)
  break

// Äá»‹nh nghÄ©a hÃ m
const handleSeerInvestigation = (action: RoleAction) => {
  if (action.targetPlayerId) {
    const targetRole = gameStore.playerRoles[action.targetPlayerId]
    const isWerewolf = targetRole === 'werewolf'
    
    investigationResults.value.set(action.playerId, isWerewolf)
    results.value.push({
      playerId: action.playerId,
      action: 'investigate',
      success: true,
      message: isWerewolf ? 'ÄÃ³ lÃ  sÃ³i' : 'ÄÃ³ khÃ´ng pháº£i sÃ³i',
      affectedPlayer: action.targetPlayerId
    })
  }
}
```

### BÆ°á»›c 3: ThÃªm báº£n dá»‹ch

**en.json:**
```json
{
  "roles": {
    "seer": {
      "name": "Seer",
      "description": "Each night, choose a player to learn if they are a werewolf or not."
    }
  }
}
```

**vi.json:**
```json
{
  "roles": {
    "seer": {
      "name": "TiÃªn Tri",
      "description": "Má»—i Ä‘Ãªm, chá»n má»™t ngÆ°á»i chÆ¡i Ä‘á»ƒ biáº¿t há» cÃ³ pháº£i sÃ³i hay khÃ´ng."
    }
  }
}
```

---

## âš ï¸ Nhá»¯ng Lá»—i ThÆ°á»ng Gáº·p

### âŒ QuÃªn thÃªm nightOrder
Káº¿t quáº£: NhÃ¢n váº­t khÃ´ng xuáº¥t hiá»‡n trong thá»© tá»± Ä‘Ãºng

**Fix:** ThÃªm `nightOrder: <sá»‘>` vÃ o táº¥t cáº£ role

### âŒ Äá»ƒ ngÆ°á»i chÆ¡i cháº¿t Ä‘Æ°á»£c chá»n lÃ m má»¥c tiÃªu
Káº¿t quáº£: TiÃªn tri Ä‘iá»u tra ngÆ°á»i cháº¿t

**Fix:** Kiá»ƒm tra `gameStore.alivePlayers.includes(targetId)`

### âŒ Báº£o vá»‡ Ä‘Æ°á»£c Ã¡p dá»¥ng SAU khi ngÆ°á»i cháº¿t
Káº¿t quáº£: NgÆ°á»i báº£o vá»‡ váº«n cháº¿t

**Fix:** Kiá»ƒm tra báº£o vá»‡ TRÆ¯á»šC tiÃªu diá»‡t

### âŒ QuÃªn filter FIRST_NIGHT
Káº¿t quáº£: Cupid gá»i vÃ o Ä‘Ãªm 2

**Fix:** Kiá»ƒm tra `role.nightly === 'FIRST_NIGHT' && gameStore.round !== 1`

### âŒ KhÃ´ng theo dÃµi sá»­ dá»¥ng kháº£ nÄƒng
Káº¿t quáº£: PhÃ¹ thá»§y dÃ¹ng Ä‘á»™c vÃ´ sá»‘ láº§n

**Fix:** Äáº·t cá» `witchPoisonUsed = true` sau khi sá»­ dá»¥ng

---

## ğŸ“ˆ Lá»™ TrÃ¬nh Triá»ƒn Khai

### Tuáº§n 1-2: Ná»n Táº£ng (20 giá»)
- [ ] Cáº­p nháº­t Role interface
- [ ] ThÃªm Phase 1 roles
- [ ] Cáº­p nháº­t game store
- [ ] Táº¡o components cÆ¡ báº£n

### Tuáº§n 2-3: Phase 1 (20 giá»)
- [ ] TiÃªn Tri
- [ ] PhÃ¹ Thá»§y
- [ ] Báº£o Vá»‡
- [ ] SÃ³i Con & SÃ³i Tuyáº¿t

### Tuáº§n 3-4: Phase 2 (25 giá»)
- [ ] Tháº§n TÃ¬nh YÃªu
- [ ] Káº» Pháº£n Bá»™i
- [ ] Sinh ÄÃ´i
- [ ] Káº» Say RÆ°á»£u
- [ ] Má»¥ GiÃ 
- [ ] NgÆ°á»i NhÃ¢n Báº£n
- [ ] NhÃ  TiÃªn Tri

### Tuáº§n 4-5: Phase 3 (30 giá»)
- [ ] Ma CÃ  Rá»“ng
- [ ] Káº» SÃ¹ng Äáº¡o
- [ ] Thá»£ SÄƒn
- [ ] CÃ¡c vai trÃ² Phase 3 khÃ¡c

### Tuáº§n 5-6: Phase 4 & Kiá»ƒm Thá»­ (30 giá»)
- [ ] CÃ¡c vai trÃ² cÃ²n láº¡i
- [ ] Kiá»ƒm thá»­ E2E
- [ ] Fix bug
- [ ] Tá»‘i Æ°u

**Tá»•ng cá»™ng: 200-250 giá» (~6 tuáº§n)**

---

## ğŸ¯ TiÃªu ChÃ­ ThÃ nh CÃ´ng

### Phase 1 HoÃ n ThÃ nh âœ…
- âœ… TiÃªn Tri cÃ³ thá»ƒ Ä‘iá»u tra
- âœ… PhÃ¹ Thá»§y cÃ³ thá»ƒ chá»¯a/Ä‘á»™c
- âœ… Báº£o Vá»‡ cÃ³ thá»ƒ báº£o vá»‡
- âœ… Táº¥t cáº£ loáº¡i hÃ nh Ä‘á»™ng hoáº¡t Ä‘á»™ng
- âœ… KhÃ´ng cÃ³ xung Ä‘á»™t giáº£i quyáº¿t sai

### Phase 2 HoÃ n ThÃ nh âœ…
- âœ… TÃ¬nh yÃªu cháº¿t theo nhau
- âœ… Minion biáº¿t danh tÃ­nh sÃ³i
- âœ… CÃ¡c liÃªn há»‡ khÃ¡c hoáº¡t Ä‘á»™ng

### Full Implementation âœ…
- âœ… Táº¥t cáº£ 30+ role hoáº¡t Ä‘á»™ng
- âœ… KhÃ´ng lá»—i console
- âœ… UI thÃ¢n thiá»‡n vá»›i GM
- âœ… Báº£n dá»‹ch tiáº¿ng Viá»‡t

---

## ğŸ“š TÃ i Liá»‡u Chi Tiáº¿t

Äá»ƒ hiá»ƒu rÃµ hÆ¡n, Ä‘á»c:

1. **NIGHT_PHASE_SPEC.md** - MÃ´ táº£ chi tiáº¿t má»—i role
2. **IMPLEMENTATION_GUIDE.md** - HÆ°á»›ng dáº«n ká»¹ thuáº­t
3. **QUICK_REFERENCE.md** - Tham kháº£o nhanh
4. **FILES_TO_MODIFY.md** - Tá»‡p nÃ o cáº§n sá»­a

---

## ğŸš€ Báº¯t Äáº§u Ngay

### BÆ°á»›c 1: Hiá»ƒu Kiáº¿n TrÃºc (1 giá»)
- Äá»c file `app/stores/roles.ts`
- Äá»c file `app/components/RoleActionPanel.vue`
- Äá»c file `app/composables/useNightPhaseActions.ts`

### BÆ°á»›c 2: Cáº­p Nháº­t Interface (1 giá»)
- ThÃªm `nightOrder`, `actionType` vÃ o Role
- ThÃªm tráº¡ng thÃ¡i vÃ o game store

### BÆ°á»›c 3: ThÃªm Phase 1 Roles (1 giá»)
- Uncomment Seer, Witch, Body Guard
- ThÃªm cÃ¡c trÆ°á»ng má»›i

### BÆ°á»›c 4: Triá»ƒn Khai Phase 1 (4-6 giá»)
- ThÃªm handlers
- Cáº­p nháº­t UI
- ThÃªm báº£n dá»‹ch

### BÆ°á»›c 5: Kiá»ƒm Thá»­ (2 giá»)
- Test tÃ¬m hiá»ƒu, báº£o vá»‡, chá»¯a/Ä‘á»™c
- Fix bug

### BÆ°á»›c 6: Tiáº¿p Tá»¥c Phase 2, 3, 4
- Láº·p láº¡i cÃ¡c bÆ°á»›c trÃªn

---

## ğŸ’¡ Máº¹o Há»¯u Ãch

1. **Sáº¯p xáº¿p role Ä‘Ãºng**: DÃ¹ng `nightOrder` Ä‘á»ƒ sáº¯p xáº¿p, khÃ´ng sáº¯p xáº¿p ngáº«u nhiÃªn

2. **Kiá»ƒm tra ngÆ°á»i sá»‘ng**: LuÃ´n kiá»ƒm tra `gameStore.alivePlayers` trÆ°á»›c khi chá»n má»¥c tiÃªu

3. **Theo dÃµi kháº£ nÄƒng**: DÃ¹ng flag boolean cho kháº£ nÄƒng 1 láº§n (Witch potions)

4. **Test tá»«ng phase**: KhÃ´ng chá» tá»›i cuá»‘i rá»“i test

5. **DÃ¹ng console.log**: Debug thÆ°á»ng xuyÃªn Ä‘á»ƒ hiá»ƒu flow

---

## ğŸ® Quy TrÃ¬nh Game Master

1. GM báº¯t Ä‘áº§u trÃ² chÆ¡i
2. Chá»‰ Ä‘á»‹nh vai trÃ² cho ngÆ°á»i chÆ¡i
3. VÃ o ban Ä‘Ãªm:
   - Chá»n tá»«ng role theo thá»© tá»±
   - Thá»±c hiá»‡n hÃ nh Ä‘á»™ng
   - Tiáº¿p tá»¥c role tiáº¿p theo
4. HoÃ n thÃ nh ban Ä‘Ãªm
5. Hiá»ƒn thá»‹ káº¿t quáº£
6. VÃ o ban ngÃ y

---

## â“ CÃ¢u Há»i ThÆ°á»ng Gáº·p

**Q: CÃ³ pháº£i implement táº¥t cáº£ 42 role khÃ´ng?**
A: KhÃ´ng, chá»‰ implement role trong `defaultRoles` array

**Q: Táº¡i sao cáº§n nightOrder?**
A: Äá»ƒ gá»i role theo thá»© tá»± Ä‘Ãºng (TiÃªn Tri trÆ°á»›c, SÃ³i sau, v.v.)

**Q: LÃ m sao xá»­ lÃ½ kháº£ nÄƒng 1 láº§n?**
A: DÃ¹ng `maxUsesPerGame: 1` vÃ  flag `witchHealUsed`

**Q: Náº¿u 2 ngÆ°á»i cháº¿t cÃ¹ng 1 Ä‘Ãªm?**
A: Cáº£ 2 cháº¿t, hiá»ƒn thá»‹ trong morning report

**Q: CÃ¡c nhÃ¢n váº­t Ä‘Ãªm Ä‘áº§u gá»i khi nÃ o?**
A: Chá»‰ gá»i khi `gameStore.round === 1`

---

## âœ… Checklist Báº¯t Äáº§u

- [ ] ÄÃ£ Ä‘á»c SUMMARY.md
- [ ] ÄÃ£ hiá»ƒu kiáº¿n trÃºc hiá»‡n táº¡i
- [ ] ÄÃ£ chuáº©n bá»‹ cáº­p nháº­t Role interface
- [ ] ÄÃ£ lÃªn káº¿ hoáº¡ch Phase 1
- [ ] Sáºµn sÃ ng báº¯t Ä‘áº§u code

---

**Tá»•ng Thá»i Gian Dá»± Kiáº¿n: 200-250 giá»**

**Báº¯t Äáº§u Ngay!** âœ¨


